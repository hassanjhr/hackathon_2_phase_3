---
id: 0001
title: Initialize Todo Full-Stack Constitution
stage: constitution
date: 2026-02-06
surface: agent
model: claude-sonnet-4-5-20250929
feature: none
branch: master
user: user
command: /sp.constitution
labels: ["constitution", "initialization", "todo-app", "security", "authentication", "spec-driven-dev"]
links:
  spec: null
  ticket: null
  adr: null
  pr: null
files:
  - .specify/memory/constitution.md
  - .specify/templates/plan-template.md
  - .specify/templates/spec-template.md
  - .specify/templates/tasks-template.md
tests:
  - none
---

## Prompt

/sp.constitution

Project: Todo Full-Stack Web Application (Auth + API + Frontend)

Objective:
Transform a console-based Todo application into a modern, secure, multi-user full-stack web application using a fully spec-driven, agentic development workflow. No manual coding is allowed.

Core principles:
- Spec-first development (all behavior defined before implementation)
- Security by default (authentication and authorization enforced everywhere)
- User data isolation (no cross-user data access)
- Reproducibility (every feature traceable to a written spec)
- Automation-first (Claude Code generates all implementation)
- Production realism (real database, real auth, real APIs)

Key standards:
- All features must be explicitly defined in specs before implementation
- All API endpoints must be RESTful and documented
- Authentication is mandatory for every API request
- JWT-based authentication must be verified server-side
- Task ownership must be enforced at the database query level
- No frontend or backend logic may bypass authentication checks
- Errors must return proper HTTP status codes (401, 403, 404, 422, 500)

Technology constraints:
- Frontend: Next.js 16+ using App Router
- Backend: Python FastAPI
- ORM: SQLModel
- Database: Neon Serverless PostgreSQL
- Authentication: Better Auth (JWT-based)
- Spec system: Spec-Kit Plus
- Development workflow: Write spec ‚Üí Generate plan ‚Üí Break into tasks ‚Üí Implement
- Manual coding: NOT allowed

Security constraints:
- All API routes require a valid JWT token
- JWT tokens must be verified using a shared secret
- User identity must be extracted from JWT, not request body
- URL user_id must match authenticated user_id
- Requests without valid tokens must return 401 Unauthorized
- Users may only access their own tasks
- Token expiration must be respected

Functional constraints:
- Implement all 5 basic Todo features:
  - Create task
  - List tasks
  - View task details
  - Update task
  - Delete task
  - Toggle task completion
- Support multiple users
- Persist data in PostgreSQL
- Frontend must be responsive and usable on desktop and mobile
- API and frontend must communicate exclusively via REST

Non-functional constraints:
- Clear separation between frontend and backend services
- Stateless backend authentication
- Consistent data models across API and database
- Predictable API behavior and responses
- Clean, readable, maintainable generated code

Success criteria:
- All features implemented exactly as defined in specs
- Authentication fully functional end-to-end
- Users can only see and modify their own tasks
- All API endpoints are JWT-protected
- Frontend successfully consumes backend APIs
- Data persists correctly in Neon PostgreSQL
- Project follows the complete Agentic Dev Stack workflow
- Project is reviewable, traceable, and judge-ready

## Response snapshot

Created initial constitution v1.0.0 for Todo Full-Stack Web Application with 6 core principles:

1. **Spec-First Development**: All behavior must be defined in written specifications before implementation
2. **Security by Default**: Authentication and authorization enforced at every layer
3. **User Data Isolation**: Users can only access their own data; cross-user access prohibited
4. **Reproducibility**: Every feature traceable to written artifacts (specs, plans, tasks, ADRs, PHRs)
5. **Automation-First**: All code generated by Claude Code agents; no manual coding
6. **Production Realism**: Production-grade technologies (Neon PostgreSQL, Better Auth, FastAPI, Next.js)

Added sections:
- Technology Stack (mandatory technologies and constraints)
- Security Requirements (JWT authentication flow and security standards)
- Development Workflow (5-stage workflow: Specify ‚Üí Plan ‚Üí Tasks ‚Üí Implement ‚Üí Validate)
- Governance (amendment process, compliance verification, enforcement)

Updated dependent templates:
- plan-template.md: Added detailed constitution checks for all 6 principles
- spec-template.md: Added mandatory Security Requirements section
- tasks-template.md: Enhanced foundational phase with JWT verification and data isolation tasks

## Outcome

- ‚úÖ Impact: Established authoritative governance document for Todo Full-Stack Web Application project with 6 core principles, technology stack requirements, security standards, and development workflow
- üß™ Tests: N/A (constitution is governance document)
- üìÅ Files: Created/updated 4 files (constitution.md, plan-template.md, spec-template.md, tasks-template.md)
- üîÅ Next prompts: /sp.specify to create first feature specification following constitution principles
- üß† Reflection: Constitution successfully captures all project requirements including security-first approach, agent-based automation, and production realism. Templates now enforce constitutional compliance at each workflow stage.

## Evaluation notes (flywheel)

- Failure modes observed: None
- Graders run and results (PASS/FAIL): N/A (initial constitution)
- Prompt variant (if applicable): N/A
- Next experiment (smallest change to try): Begin feature specification using /sp.specify to validate constitution principles in practice
